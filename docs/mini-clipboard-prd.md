# Mini Clipboard（macOS）产品需求文档（PRD）

## 1. 产品概述
- 目标：实现一款macOS 剪贴板管理应用，提供无限历史、快速检索、收藏与顺序粘贴等能力，提升跨应用与跨设备的粘贴效率。
- 价值：缩短复制-粘贴链路，把“临时剪贴板”升级为“可搜索、可组织、可协作的信息库”。
- 平台范围：macOS（优先），后续扩展 iOS/iPadOS。

## 2. 目标与成功标准
- 日活用户的剪贴频次 ≥ 20 次/天，90% 操作可通过键盘完成。
- 搜索召回命中率 ≥ 90%，平均打开到粘贴用时 ≤ 2 秒。
- 同步延迟 ≤ 3 秒（同一 Apple 账户下多设备）。
- 隐私合规：敏感应用默认忽略；屏幕共享时可隐藏；数据仅存储至用户 iCloud（或本地）。

## 3. 范围定义
### 3.1 MVP 核心功能
1) 剪贴板历史采集与时间线浏览
2) 全局搜索与过滤
3) Pinboards（收藏夹）组织
4) 直接粘贴到前台应用（需辅助功能权限）
5) 快速粘贴（数字快捷键）
6) Paste Stack（顺序粘贴栈）
7) 预览与轻编辑（Quick Look、文本编辑、纯文本粘贴）
8) 同步（iCloud，可关闭）
9) 隐私与规则（历史周期、忽略敏感应用、屏幕共享隐私）
10) 键盘快捷键与设置

### 3.2 后续版本（V1+）
- 共享 Pinboards 协作与团队版（权限、邀请、冲突合并）
- 图像工具（旋转、取色）、OCR 文本识别、链接富预览内置浏览器
- Apple Intelligence 写作辅助（改写、校对、摘要等）
- 更强搜索语法（标签/来源/类型组合、保存的过滤器）

## 4. 用户画像与关键场景
- 开发者/写作者/设计师/运营：高频复制、跨应用拼装内容、常用片段复用。
- 关键场景：
  - 找回最近 100 次复制内容并快速粘贴至当前编辑器。
  - 将多段文本按指定顺序从 A 应用复制到 B 应用。
  - 将常用模板、链接、代码片段固定到 Pinboards 并一键投递。

## 5. 功能需求与验收标准
### 5.1 剪贴板历史采集
- 需求：后台监听系统剪贴板变更，保存文本、链接、图片、文件引用、颜色等类型。
- 显示：横向时间线卡片，含缩略图/类型/来源 App/时间戳。
- 操作：多选、删除、复制回系统剪贴板、拖拽到目标应用。
- 验收：
  - 连续复制 100 次，历史完整保留；滚动/导航无卡顿（60fps 目标）。
  - 删除与还原（复制回剪贴板）行为正确；无数据错位。

### 5.2 时间线浏览与导航
- 需求：`⇧+⌘+V` 呼出/隐藏；方向键左右移动；`⌘+↑/↓` 跳至首/尾；`Space` 预览。
- 验收：呼出面板 ≤ 150ms；所有导航快捷键响应及时。

### 5.3 搜索与过滤
- 需求：支持关键词检索、内容类型过滤（Text/Image/Link/File）、来源 App 过滤（如 Safari/Notes）。
- 验收：
  - 输入任意关键词后 ≤ 200ms 出现结果；
  - 结果中回车/Tab 可顺序浏览；
  - 组合过滤（类型+来源）正确命中。

### 5.4 Pinboards（收藏夹）
- 需求：创建/重命名/颜色标记/排序；从历史拖拽或右键加入；与历史独立（删除历史不影响收藏）。
- 验收：增删改查无误；跨设备同步状态一致；拖拽排序持久化。

### 5.5 直接粘贴到前台应用
- 需求：启用 macOS “辅助功能”权限后，支持从历史或 Pinboards 直接粘贴到最前应用。
- 行为：发送系统快捷 `⌘+V`；Stack 模式下可发送 `⌘+C/⌘+V` 组合。
- 验收：权限引导清晰；在常见应用（浏览器/编辑器/Office）均能成功粘贴。

### 5.6 快速粘贴（数字快捷键）
- 需求：在当前列表中，`⌘+1…9` 直接粘贴第 N 项；`⇧+⌘+1…9` 以纯文本粘贴。
- 验收：9 个位置稳定工作；纯文本模式不带格式。

### 5.7 Paste Stack（顺序粘贴栈）
- 需求：`⇧+⌘+C` 激活；之后复制的内容按序入栈；`⌘+V` 依次投递；支持反转顺序、用后移除、滑动删除。
- 验收：跨应用复制 10+ 项后可按序粘贴到目标；方向切换正确；已用项自动出栈。

### 5.8 预览与轻编辑
- 需求：Quick Look 预览；文本项可编辑与重命名（编辑后转为纯文本）；链接富预览；图片缩略图。
- 验收：`Space` 预览打开 ≤ 200ms；编辑保存后同步更新；富预览加载稳定。

### 5.9 纯文本粘贴
- 需求：支持全局“Always paste as Plain Text”开关；单次 `⇧+Return` 纯文本粘贴。
- 验收：格式剥离准确；不改变系统剪贴板原始内容（除非明确操作）。

### 5.10 同步
- 需求：iCloud 私有同步（同 Apple ID）；可在设置中开关；离线可用，恢复时合并；冲突以时间线为准。
- 验收：两台设备复制后 ≤ 3 秒呈现一致；离线新增项上线后合并无丢失。

### 5.11 隐私与规则
- 需求：
  - 历史保存周期可调（默认 1 个月）。
  - 忽略敏感应用（密码管理器等，默认启用）。
  - 屏幕共享隐私：可隐藏面板与敏感缩略图。
- 验收：规则生效即时；屏幕共享时不会泄露内容；历史按周期自动清理。

### 5.12 设置与快捷键
- 需求：集中设置面板（General/Privacy/Rules/Sync/Shortcuts）；常用快捷可配置。
- 验收：设置项写入持久化；冲突快捷提示并引导修改。

## 6. 非功能性需求
- 性能：主面板唤起 ≤ 150ms；列表滚动 60fps；索引构建后台进行。
- 稳定性：异常崩溃率 < 0.1%；断电/崩溃不丢数据（写入原子化）。
- 安全与隐私：仅本机与用户 iCloud；不采集未授权数据；遵循苹果公证与沙盒要求。
- 兼容性：macOS 12+，Apple Silicon 原生；常见输入法与编辑器兼容。
- 本地化：中文/英文；右到左语言排期。

## 7. UI/交互规范（MVP）
- 信息架构：
  - 顶部工具栏：Clipboard/Pinboards 标签、搜索、`+` 创建、设置入口。
  - 主视图：横向卡片时间线或当前 Pinboard 列表。
  - 预览层：`Space` 覆盖式预览（文本、链接、图片）。
- 导航与操作：
  - 默认隐藏；`⇧+⌘+P`呼出；失去焦点后隐藏；方向键左右；`Return` 粘贴；`⇧+Return` 纯文本；`⌘+E/⌘+R` 编辑/重命名。
  - 拖拽：历史→应用、历史→Pinboard、Pinboard 排序。
- 视觉：遵循 macOS 原生与暗/亮模式；抽屉式弹出；卡片显示缩略图+来源+时间戳；Pinboard 支持颜色标记。

## 8. 数据模型（示意）
- Item
  - `id`（UUID）、`type`（text/link/image/file/color）、`contentRef`（文本/文件路径/Blob）、`sourceApp`、`copiedAt`、`metadata`（url/title/thumbnail）、`tags`、`isPinned`。
- Pinboard
  - `id`、`name`、`color`、`order`、`createdAt`、`updatedAt`。
- Stack
  - `items: [itemId]`、`direction: asc|desc`、`active: boolean`。
- Settings
  - `historyRetentionDays`、`ignoredApps[]`、`syncEnabled`、`privacy:{hideOnScreenShare}`、`shortcuts{...}`。

## 9. 边界与异常处理
- 未授权辅助功能：禁止直接粘贴与 Stack 投递，提示授权并提供引导。
- 受限应用窗口（不可粘贴）：回退为“复制到系统剪贴板”策略。
- 大型内容（>10MB 图像/文件）：异步缩略图与延迟加载；粘贴采用文件引用/临时文件。
- 冲突：双端同时编辑同一 Pinboard 时以时间戳合并，保留两版并标注冲突。

## 10. 指标与埋点
- 唤起次数、搜索查询、粘贴成功率、Stack 使用率、Pinboards 交互；
- 授权漏斗（辅助功能/iCloud）、隐私规则触发；性能指标（唤起、搜索响应）。

## 11. 里程碑计划
- Phase 0：技术验证（剪贴板监听、面板唤起、直接粘贴权限流、索引/搜索）— 2 周。
- MVP（本 PRD 范围）：核心 10 项功能与 UI/交互完成 — 6–8 周。
- V1+：共享 Pinboards、OCR 与图像工具、AI 写作辅助 — 4–6 周。

## 12. 依赖与风险
- 依赖：macOS 辅助功能权限、iCloud 同步框架、Quick Look、系统分享。
- 风险：权限被拒导致体验降级；超大历史占用磁盘；跨设备冲突与网络抖动。

---

> 本 PRD 面向实现 Mini Clipboard 等效体验的 macOS 版本，细节以设计/开发评审为准；涉及协作与 AI 功能为后续版本目标。
